<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#f97316">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Manutenção MP">
<title>Manutenção Preventiva</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700;800&family=Barlow:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<style>
:root {
  --bg:#0b0f18; --surface:#131926; --s2:#1a2236; --s3:#1e2a40; --border:#2a3550;
  --accent:#f97316; --accent2:#fb923c; --ok:#22c55e; --warn:#eab308;
  --danger:#ef4444; --info:#38bdf8; --text:#dde4f0; --muted:#7a8aaa;
  --safe-top:env(safe-area-inset-top,0px); --safe-bot:env(safe-area-inset-bottom,0px);
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html{height:100%}
body{background:var(--bg);color:var(--text);font-family:'Barlow',sans-serif;font-weight:300;min-height:100%;overscroll-behavior:none}

/* LOGIN */
#screen-login{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:24px;background:radial-gradient(ellipse at 60% 20%,rgba(249,115,22,.12) 0%,transparent 60%),var(--bg)}
.login-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:36px 32px;width:100%;max-width:400px;box-shadow:0 24px 64px rgba(0,0,0,.5)}
.login-logo{width:56px;height:56px;background:var(--accent);border-radius:12px;display:grid;place-items:center;font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:26px;color:#000;margin:0 auto 20px}
.login-card h2{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.8rem;text-align:center;text-transform:uppercase;letter-spacing:.04em;margin-bottom:6px}
.login-card p.sub{font-size:.78rem;color:var(--muted);text-align:center;text-transform:uppercase;letter-spacing:.08em;margin-bottom:28px}
.login-field{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}
.login-field label{font-size:.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:.07em}
.login-field input{background:var(--s2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'Barlow',sans-serif;font-size:.95rem;padding:10px 14px;transition:border-color .18s}
.login-field input:focus{outline:none;border-color:var(--accent);background:#1f2d44}
.btn-primary{width:100%;background:var(--accent);color:#000;border:none;border-radius:8px;padding:12px;font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:1.05rem;letter-spacing:.05em;text-transform:uppercase;cursor:pointer;transition:background .15s,transform .1s;margin-top:6px}
.btn-primary:hover{background:var(--accent2)}.btn-primary:active{transform:scale(.98)}.btn-primary:disabled{opacity:.6;cursor:not-allowed}
.login-err{color:var(--danger);font-size:.8rem;min-height:18px;margin-top:4px;text-align:center}
.btn-link{background:none;border:none;color:var(--muted);font-family:'Barlow',sans-serif;font-size:.8rem;cursor:pointer;margin-top:14px;text-align:center;display:block;width:100%;text-decoration:underline;padding:0}
.btn-link:hover{color:var(--text)}

/* APP */
#screen-app{display:none}
header{background:var(--surface);border-bottom:3px solid var(--accent);padding:calc(12px + var(--safe-top)) 16px 12px;display:flex;align-items:center;gap:12px;position:sticky;top:0;z-index:100;box-shadow:0 4px 20px rgba(0,0,0,.4)}
.logo{width:38px;height:38px;background:var(--accent);border-radius:7px;display:grid;place-items:center;font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:18px;color:#000;flex-shrink:0}
.h-title{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.2rem;text-transform:uppercase;letter-spacing:.04em;line-height:1}
.h-sub{font-size:.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:.07em;margin-top:2px}
.h-right{margin-left:auto;display:flex;align-items:center;gap:8px}
.today-pill{background:var(--s2);border:1px solid var(--border);border-radius:20px;padding:4px 12px;font-size:.72rem;color:var(--muted);white-space:nowrap}
.today-pill strong{color:var(--accent);font-family:'Barlow Condensed',sans-serif;font-size:.88rem}
.btn-icon{background:var(--s2);border:1px solid var(--border);border-radius:7px;color:var(--text);width:36px;height:36px;display:grid;place-items:center;cursor:pointer;transition:background .15s;position:relative;flex-shrink:0}
.btn-icon:hover{background:var(--s3);border-color:var(--accent)}
.menu-dropdown{position:absolute;top:calc(100% + 8px);right:0;background:var(--surface);border:1px solid var(--border);border-radius:10px;min-width:220px;box-shadow:0 12px 40px rgba(0,0,0,.5);display:none;flex-direction:column;overflow:hidden;z-index:200}
.menu-dropdown.open{display:flex}
.menu-item{padding:11px 16px;display:flex;align-items:center;gap:10px;font-size:.85rem;cursor:pointer;transition:background .12s;border:none;background:none;color:var(--text);text-align:left;font-family:'Barlow',sans-serif;font-weight:400}
.menu-item:hover{background:var(--s2)}.menu-item.danger{color:var(--danger)}
.menu-sep{height:1px;background:var(--border);margin:4px 0}
.menu-user{padding:12px 16px;font-size:.75rem;color:var(--muted);border-bottom:1px solid var(--border)}
#sync-indicator{font-size:.7rem;color:var(--muted);transition:opacity .4s;white-space:nowrap}
#btn-install{display:none}
.btn-install-pill{background:var(--accent);color:#000;border:none;border-radius:20px;padding:5px 12px;font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:.8rem;cursor:pointer;display:flex;align-items:center;gap:5px}
.container{padding:16px}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:16px}
@media(min-width:600px){.stats{grid-template-columns:repeat(4,1fr)}}
.stat-card{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:12px 14px;position:relative;overflow:hidden}
.stat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.stat-card.danger::before{background:var(--danger)}.stat-card.warn::before{background:var(--warn)}.stat-card.ok::before{background:var(--ok)}.stat-card.accent::before{background:var(--accent)}
.s-label{font-size:.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:.09em;margin-bottom:4px}
.s-value{font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:2rem;line-height:1}
.stat-card.danger .s-value{color:var(--danger)}.stat-card.warn .s-value{color:var(--warn)}.stat-card.ok .s-value{color:var(--ok)}.stat-card.accent .s-value{color:var(--accent)}
.panel{background:var(--surface);border:1px solid var(--border);border-radius:10px;overflow:hidden}
.panel-head{background:var(--s2);border-bottom:1px solid var(--border);padding:10px 16px;display:flex;align-items:center;gap:8px;font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:.85rem;letter-spacing:.07em;text-transform:uppercase;color:var(--accent)}
.hint{margin-left:auto;font-size:.65rem;color:var(--muted);font-family:'Barlow',sans-serif;font-weight:300;letter-spacing:0;text-transform:none}
.tbl-scroll{overflow-x:auto;-webkit-overflow-scrolling:touch}
table{width:100%;border-collapse:collapse;font-size:.78rem}
thead tr{background:var(--s3);border-bottom:2px solid var(--accent)}
thead th{padding:8px 10px;text-align:left;font-family:'Barlow Condensed',sans-serif;font-weight:600;font-size:.7rem;letter-spacing:.07em;text-transform:uppercase;color:var(--muted);white-space:nowrap}
thead th.col-accent{color:var(--accent)}thead th.col-info{color:var(--info)}thead th.col-ok{color:var(--ok)}
tbody tr{border-bottom:1px solid var(--border);transition:background .12s}
tbody tr:active{background:rgba(249,115,22,.06)}
tbody td{padding:7px 10px;vertical-align:middle}
.tear-num{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.05rem;color:var(--accent)}
.model-name{font-size:.7rem;color:var(--muted);white-space:nowrap}
.cell-input{background:var(--s2);border:1px solid var(--border);border-radius:5px;color:var(--text);font-family:'Barlow',sans-serif;font-size:.78rem;padding:5px 7px;transition:border-color .18s;width:100%;-webkit-appearance:none}
.cell-input:focus{outline:none;border-color:var(--accent);background:#1f2d44}
.cell-input::placeholder{color:#3a4a60}
.input-num{text-align:right;min-width:105px}.input-date{min-width:130px;color-scheme:dark}
.inp-accent{border-color:rgba(249,115,22,.4)!important}.inp-info{border-color:rgba(56,189,248,.35)!important}
.chip{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:20px;font-size:.65rem;font-weight:600;font-family:'Barlow Condensed',sans-serif;letter-spacing:.05em;text-transform:uppercase;white-space:nowrap}
.chip::before{content:'';width:5px;height:5px;border-radius:50%;flex-shrink:0}
.chip-danger{background:rgba(239,68,68,.12);color:var(--danger)}.chip-danger::before{background:var(--danger)}
.chip-warn{background:rgba(234,179,8,.12);color:var(--warn)}.chip-warn::before{background:var(--warn)}
.chip-ok{background:rgba(34,197,94,.12);color:var(--ok)}.chip-ok::before{background:var(--ok)}
.chip-done{background:rgba(56,189,248,.12);color:var(--info)}.chip-done::before{background:var(--info)}
.chip-na{background:rgba(122,138,170,.1);color:var(--muted)}.chip-na::before{background:var(--muted)}
.fc-date{font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:.9rem;line-height:1}
.fc-days{font-size:.65rem;color:var(--muted);margin-top:1px}
.bar-wrap{width:60px;height:5px;background:var(--s3);border-radius:4px;overflow:hidden}
.bar-fill{height:5px;border-radius:4px;transition:width .35s}
.legend{display:flex;align-items:center;gap:14px;flex-wrap:wrap;padding:10px 16px;border-top:1px solid var(--border);background:var(--s2);font-size:.68rem;color:var(--muted)}
.legend-item{display:flex;align-items:center;gap:5px}
.leg-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
@media(max-width:640px){.hide-mobile{display:none!important}}

/* ── BOTÕES DE AÇÃO NA TABELA ── */
.btn-action{background:none;border:none;cursor:pointer;padding:4px 6px;border-radius:6px;transition:background .15s;line-height:1;display:inline-flex;align-items:center;justify-content:center}
.btn-wrench{color:#94a3b8}.btn-wrench:hover{background:rgba(249,115,22,.15);color:var(--accent)}
.btn-finish{color:#94a3b8}.btn-finish:hover{background:rgba(34,197,94,.15);color:var(--ok)}
.btn-wrench.active{color:var(--accent);animation:pulse-orange 1.5s infinite}
@keyframes pulse-orange{0%,100%{opacity:1}50%{opacity:.5}}

/* ── CRONÔMETRO NA LINHA ── */
.row-timer{font-family:'Barlow Condensed',sans-serif;font-size:.8rem;color:var(--accent);font-weight:700;white-space:nowrap;min-width:48px;text-align:center}

/* ── MODAL CHECKLIST ── */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:500;display:none;align-items:flex-start;justify-content:center;padding:0;overflow:hidden}
.modal-overlay.open{display:flex}
.modal-box{background:var(--surface);border:1px solid var(--border);border-radius:16px 16px 0 0;width:100%;max-width:860px;height:100dvh;display:flex;flex-direction:column;margin-top:auto;animation:slideUp .3s ease}
@media(min-width:680px){.modal-box{border-radius:16px;height:92dvh;margin:auto}}
@keyframes slideUp{from{transform:translateY(40px);opacity:0}to{transform:translateY(0);opacity:1}}
.modal-header{background:var(--s2);border-bottom:3px solid var(--accent);padding:14px 18px;display:flex;align-items:center;gap:12px;flex-shrink:0}
.modal-title{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.2rem;text-transform:uppercase;letter-spacing:.04em}
.modal-timer{background:rgba(249,115,22,.15);border:1px solid rgba(249,115,22,.3);border-radius:8px;padding:5px 12px;font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:1.1rem;color:var(--accent);letter-spacing:.05em}
.modal-close{margin-left:auto;background:var(--s3);border:1px solid var(--border);border-radius:7px;color:var(--muted);width:32px;height:32px;display:grid;place-items:center;cursor:pointer;font-size:1.1rem}
.modal-close:hover{color:var(--text);border-color:var(--accent)}
.modal-body{flex:1;overflow-y:auto;padding:0}
.modal-footer{border-top:1px solid var(--border);padding:14px 18px;display:flex;gap:10px;flex-shrink:0;background:var(--surface)}

/* Checklist header */
.cl-head{display:grid;grid-template-columns:1fr 80px 80px 80px 80px 80px 70px;gap:4px;padding:8px 18px;background:var(--s3);border-bottom:1px solid var(--border);font-size:.62rem;font-weight:700;font-family:'Barlow Condensed',sans-serif;text-transform:uppercase;letter-spacing:.06em;color:var(--muted);position:sticky;top:0;z-index:10}
.cl-head span:not(:first-child){text-align:center}
@media(max-width:600px){
  .cl-head{grid-template-columns:1fr 44px 44px 44px 44px 44px 60px}
}

/* Checklist row */
.cl-row{display:grid;grid-template-columns:1fr 80px 80px 80px 80px 80px 70px;gap:4px;padding:10px 18px;border-bottom:1px solid rgba(42,53,80,.6);align-items:center;transition:background .12s}
.cl-row:hover{background:rgba(26,34,54,.5)}
@media(max-width:600px){
  .cl-row{grid-template-columns:1fr 44px 44px 44px 44px 44px 60px}
}
.cl-item-name{font-size:.82rem;color:var(--text);line-height:1.3}
.cl-check{display:flex;justify-content:center;align-items:center}
.cl-check input[type=checkbox]{width:18px;height:18px;accent-color:var(--accent);cursor:pointer}
.cl-qty{width:100%;background:var(--s2);border:1px solid var(--border);border-radius:4px;color:var(--text);font-size:.75rem;padding:3px 5px;text-align:center}
.cl-qty:focus{outline:none;border-color:var(--accent)}

/* Obs field dentro do modal */
.modal-obs{padding:14px 18px;border-bottom:1px solid var(--border)}
.modal-obs label{font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:.07em;display:block;margin-bottom:6px}
.modal-obs textarea{width:100%;background:var(--s2);border:1px solid var(--border);border-radius:7px;color:var(--text);font-family:'Barlow',sans-serif;font-size:.85rem;padding:10px 12px;resize:vertical;min-height:80px}
.modal-obs textarea:focus{outline:none;border-color:var(--accent)}

/* Progress bar do checklist */
.cl-progress{padding:10px 18px;background:var(--s2);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;font-size:.75rem;color:var(--muted)}
.cl-prog-bar{flex:1;height:6px;background:var(--s3);border-radius:4px;overflow:hidden}
.cl-prog-fill{height:6px;background:var(--ok);border-radius:4px;transition:width .3s}
.cl-prog-txt{font-family:'Barlow Condensed',sans-serif;font-weight:700;color:var(--ok);font-size:.85rem;white-space:nowrap}

/* Modal histórico */
.hist-item{padding:14px 18px;border-bottom:1px solid var(--border);display:flex;flex-direction:column;gap:6px}
.hist-item:hover{background:rgba(26,34,54,.5)}
.hist-head{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.hist-tear{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.1rem;color:var(--accent)}
.hist-modelo{font-size:.72rem;color:var(--muted)}
.hist-date{margin-left:auto;font-size:.75rem;color:var(--muted)}
.hist-meta{display:flex;gap:12px;flex-wrap:wrap;font-size:.75rem}
.hist-meta span{display:flex;align-items:center;gap:4px;color:var(--muted)}
.hist-meta strong{color:var(--text)}
.hist-obs{font-size:.78rem;color:var(--muted);font-style:italic;padding:6px 10px;background:var(--s2);border-radius:6px;border-left:2px solid var(--border)}

/* Modal conclusão (obs final) */
.modal-concl{display:flex;flex-direction:column;gap:14px;padding:20px 18px}
.modal-concl h3{font-family:'Barlow Condensed',sans-serif;font-weight:800;font-size:1.2rem;text-transform:uppercase;color:var(--ok)}
.concl-stat{background:var(--s2);border:1px solid var(--border);border-radius:8px;padding:12px 14px;display:flex;flex-direction:column;gap:6px}
.concl-stat span{font-size:.75rem;color:var(--muted)}
.concl-stat strong{font-family:'Barlow Condensed',sans-serif;font-size:1.1rem;color:var(--text)}
.concl-obs textarea{width:100%;background:var(--s2);border:1px solid var(--border);border-radius:7px;color:var(--text);font-family:'Barlow',sans-serif;font-size:.9rem;padding:12px;resize:vertical;min-height:100px}
.concl-obs textarea:focus{outline:none;border-color:var(--ok)}

/* Btn grande */
.btn-big{padding:13px 20px;border:none;border-radius:8px;font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:1rem;text-transform:uppercase;letter-spacing:.05em;cursor:pointer;transition:filter .15s;flex:1}
.btn-big:hover{filter:brightness(1.1)}.btn-big:active{filter:brightness(.95)}
.btn-big-ok{background:var(--ok);color:#000}.btn-big-cancel{background:var(--s3);color:var(--muted);border:1px solid var(--border)}
.btn-big-accent{background:var(--accent);color:#000}

/* Tab bar (histórico) */
.tab-bar{display:flex;border-bottom:1px solid var(--border);background:var(--s2)}
.tab-btn{flex:1;padding:10px;border:none;background:none;color:var(--muted);font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:.85rem;text-transform:uppercase;letter-spacing:.05em;cursor:pointer;border-bottom:2px solid transparent;transition:all .15s}
.tab-btn.active{color:var(--accent);border-bottom-color:var(--accent)}

/* Toast */
.toast{position:fixed;bottom:calc(20px + var(--safe-bot));left:50%;transform:translateX(-50%) translateY(20px);background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:10px 20px;font-size:.85rem;color:var(--text);opacity:0;transition:opacity .3s,transform .3s;z-index:999;white-space:nowrap;box-shadow:0 8px 32px rgba(0,0,0,.4)}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* Empty state */
.empty-state{padding:40px 20px;text-align:center;color:var(--muted)}
.empty-state svg{opacity:.3;margin-bottom:12px}
.empty-state p{font-size:.85rem}

/* Print */
.print-footer{display:none}
@media print{
  @page{size:A4 landscape;margin:10mm}
  *{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}
  body{background:#fff!important;color:#111!important;font-size:8pt!important}
  #screen-login,.modal-overlay{display:none!important}
  #screen-app{display:block!important}
  header{position:static!important;background:#1a1a1a!important;border-bottom:3px solid #f97316!important;padding:8px 12px!important;box-shadow:none!important}
  header *{color:#fff!important}
  .btn-icon,#btn-install,#sync-indicator,.hint,.menu-dropdown,.btn-action,.row-timer{display:none!important}
  .container{padding:6px 0!important}
  .stats{display:grid!important;grid-template-columns:repeat(4,1fr)!important;gap:6px!important;margin-bottom:8px!important}
  .stat-card{background:#f5f5f5!important;border:1px solid #ddd!important;padding:6px 10px!important}
  .panel{background:#fff!important;border:1px solid #ccc!important}
  .panel-head{background:#1a1a1a!important;color:#f97316!important;padding:5px 10px!important}
  table{font-size:6.5pt!important}
  thead tr{background:#222!important}
  thead th{background:#222!important;color:#ccc!important;padding:4px 6px!important;font-size:6pt!important}
  tbody tr{border-bottom:1px solid #e0e0e0!important;background:#fff!important}
  tbody tr:nth-child(even){background:#f9f9f9!important}
  tbody td{padding:3px 6px!important;border:1px solid #e0e0e0!important;color:#111!important}
  .tear-num{color:#ea580c!important}
  .cell-input{background:transparent!important;border:1px solid #ccc!important;color:#111!important;font-size:6.5pt!important;padding:2px 4px!important}
  .chip-danger{background:#fee2e2!important;color:#dc2626!important}
  .chip-warn{background:#fef9c3!important;color:#92400e!important}
  .chip-ok{background:#dcfce7!important;color:#166534!important}
  .chip-done{background:#e0f2fe!important;color:#0369a1!important}
  .hide-mobile{display:table-cell!important}
  .print-footer{display:block!important;text-align:right;font-size:6pt;color:#888;margin-top:6px}
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="screen-login">
  <div class="login-card">
    <div class="login-logo">MP</div>
    <h2 id="login-title">Entrar</h2>
    <p class="sub">Manutencao Preventiva</p>
    <div id="reg-fields" style="display:none;flex-direction:column;gap:14px">
      <div class="login-field"><label>Nome</label><input type="text" id="inp-name" placeholder="Seu nome completo" autocomplete="name"></div>
    </div>
    <div class="login-field"><label>E-mail</label><input type="email" id="inp-email" placeholder="seu@email.com" autocomplete="email"></div>
    <div class="login-field" id="campo-senha"><label>Senha</label><input type="password" id="inp-pass" placeholder="••••••••" autocomplete="current-password"></div>
    <div id="reset-fields" style="display:none;flex-direction:column;gap:6px">
      <div class="login-field"><label>E-mail cadastrado</label><input type="email" id="inp-reset-email" placeholder="seu@email.com" autocomplete="email"></div>
      <p style="font-size:.75rem;color:var(--muted);margin-top:2px">Voce recebera um link para criar nova senha.</p>
    </div>
    <p class="login-err" id="login-err" style="min-height:20px;font-size:.82rem;margin-top:6px;text-align:center"></p>
    <button class="btn-primary" id="btn-submit">Entrar</button>
    <button class="btn-link" id="btn-toggle-reg">Nao tem conta? Cadastre-se</button>
    <button class="btn-link" id="btn-forgot" style="font-size:.76rem;color:var(--muted);margin-top:2px">Esqueci minha senha</button>
    <button class="btn-link" id="btn-back" style="display:none;font-size:.78rem">&larr; Voltar ao login</button>
  </div>
</div>

<!-- APP -->
<div id="screen-app">
  <header>
    <div class="logo">MP</div>
    <div>
      <div class="h-title">Manutencao Preventiva</div>
      <div class="h-sub">Cronograma &amp; Previsao</div>
    </div>
    <div class="h-right">
      <div class="today-pill">Hoje: <strong id="lbl-today"></strong></div>
      <span id="sync-indicator" style="opacity:0"></span>
      <button class="btn-install-pill" id="btn-install" onclick="installPWA()">&#11015; Instalar app</button>
      <div style="position:relative">
        <button class="btn-icon" id="btn-menu" onclick="toggleMenu()" title="Menu">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        </button>
        <div class="menu-dropdown" id="menu-dropdown">
          <div class="menu-user" id="user-name">Usuario</div>
          <button class="menu-item" onclick="abrirHistorico();toggleMenu()">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            Historico de Manutencoes
          </button>
          <button class="menu-item" onclick="window.print();toggleMenu()">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
            Imprimir / PDF
          </button>
          <button class="menu-item" onclick="exportCSV();toggleMenu()">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            Exportar CSV / Excel
          </button>
          <button class="menu-item" id="btn-notif" onclick="requestNotificationPermission();toggleMenu()">
            &#128276; Ativar notificacoes
          </button>
          <div class="menu-sep"></div>
          <button class="menu-item danger" onclick="doLogout()">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
            Sair
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="stats">
      <div class="stat-card danger"><div class="s-label">Vencidos</div><div class="s-value" id="s-vencido">-</div></div>
      <div class="stat-card warn"><div class="s-label">Atencao &lt;30d</div><div class="s-value" id="s-atencao">-</div></div>
      <div class="stat-card ok"><div class="s-label">Em dia</div><div class="s-value" id="s-ok">-</div></div>
      <div class="stat-card accent"><div class="s-label">Total Teares</div><div class="s-value" id="s-total">-</div></div>
    </div>
    <div class="panel">
      <div class="panel-head">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M4.93 4.93a10 10 0 0 0 0 14.14"/></svg>
        Registro de Manutencoes
        <span class="hint hide-mobile">Campos laranja e azul sao editaveis</span>
      </div>
      <div class="tbl-scroll">
        <table>
          <thead>
            <tr>
              <th>Tear</th>
              <th>Modelo</th>
              <th class="hide-mobile">RPM</th>
              <th class="hide-mobile">Setup</th>
              <th></th>
              <th class="col-info">Data Manut.</th>
              <th class="col-accent">Realizado</th>
              <th class="col-accent">Real (Voltas)</th>
              <th class="hide-mobile">Saldo</th>
              <th class="hide-mobile">Progresso</th>
              <th class="col-ok">Proxima</th>
              <th>Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
      <div class="legend">
        <span style="font-weight:500;color:var(--text)">Legenda:</span>
        <span class="legend-item"><span class="leg-dot" style="background:var(--danger)"></span>Vencido</span>
        <span class="legend-item"><span class="leg-dot" style="background:var(--warn)"></span>Atencao (&lt;30d)</span>
        <span class="legend-item"><span class="leg-dot" style="background:var(--ok)"></span>Em dia</span>
        <span class="legend-item"><span class="leg-dot" style="background:var(--info)"></span>Manutencao realizada</span>
        <span class="legend-item">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2.5"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
          Iniciar manutencao
        </span>
        <span class="legend-item">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2.5"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
          Finalizar manutencao
        </span>
      </div>
    </div>
  </div>
  <div class="print-footer" id="print-footer"></div>
</div>

<!-- MODAL CHECKLIST -->
<div class="modal-overlay" id="modal-checklist">
  <div class="modal-box">
    <div class="modal-header">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
      <div>
        <div class="modal-title" id="cl-title">Checklist — Tear 1</div>
        <div style="font-size:.68rem;color:var(--muted);margin-top:1px" id="cl-modelo"></div>
      </div>
      <div class="modal-timer" id="modal-timer">00:00:00</div>
      <button class="modal-close" onclick="fecharChecklist()" title="Minimizar (nao perde o tempo)">&#8722;</button>
    </div>
    <div class="cl-progress">
      <span>Progresso:</span>
      <div class="cl-prog-bar"><div class="cl-prog-fill" id="cl-prog-fill" style="width:0%"></div></div>
      <span class="cl-prog-txt" id="cl-prog-txt">0 / 40</span>
    </div>
    <div class="cl-head">
      <span>Item</span>
      <span>Verif.</span>
      <span>Ajuste</span>
      <span>Limpeza</span>
      <span>Lubrif.</span>
      <span>Troca</span>
      <span>Qtde</span>
    </div>
    <div class="modal-body" id="cl-body"></div>
    <div class="modal-obs">
      <label>Observacoes gerais da manutencao</label>
      <textarea id="cl-obs" placeholder="Anote aqui qualquer observacao, peca trocada, problema encontrado..."></textarea>
    </div>
    <div class="modal-footer">
      <button class="btn-big btn-big-cancel" onclick="fecharChecklist()">Minimizar</button>
      <button class="btn-big btn-big-ok" onclick="finalizarManutencao()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" style="display:inline;vertical-align:middle;margin-right:5px"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
        Finalizar Manutencao
      </button>
    </div>
  </div>
</div>

<!-- MODAL HISTORICO -->
<div class="modal-overlay" id="modal-historico">
  <div class="modal-box">
    <div class="modal-header">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
      <div class="modal-title">Historico de Manutencoes</div>
      <button class="modal-close" onclick="fecharHistorico()" style="margin-left:auto">&#10005;</button>
    </div>
    <div class="tab-bar">
      <button class="tab-btn active" onclick="filtrarHistorico('todos',this)">Todos</button>
      <button class="tab-btn" onclick="filtrarHistorico('mes',this)">Este mes</button>
      <button class="tab-btn" onclick="filtrarHistorico('semana',this)">Esta semana</button>
    </div>
    <div class="modal-body" id="hist-body"></div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script src="app.js"></script>
</body>
</html>
